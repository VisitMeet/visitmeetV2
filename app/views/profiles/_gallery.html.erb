<%= render 'components/card', data: { controller: 'gallery' } do %>
  <h2 class="text-xl font-semibold text-gray-900 dark:text-gray-100 mb-4">Photos</h2>

  <% if is_own_profile %>
    <%= form_with model: user, url: add_photo_profile_path, method: :post, local: true, html: { multipart: true, data: { gallery_target: "form" } }, class: "mb-4" do |f| %>
      <div class="flex flex-col gap-2">
        <div class="flex items-center gap-2">
          <%= f.file_field :photos, multiple: true, class: "flex-1 rounded-md border-gray-300 dark:border-gray-600 bg-white dark:bg-gray-700", data: { action: "change->gallery#preview", gallery_target: "input" } %>
          <%= f.submit "Upload", class: "px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700" %>
        </div>
        <div data-gallery-target="previews" class="flex flex-wrap gap-2"></div>
      </div>
    <% end %>
  <% end %>

  <div data-gallery-target="gallery">
    <%= render partial: 'profiles/gallery_grid', locals: { user: user, is_own_profile: is_own_profile } %>
  </div>
<% end %>
